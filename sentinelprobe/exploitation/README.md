# SentinelProbe Exploitation Engine

The Exploitation Engine is a modular component of SentinelProbe that provides controlled, simulated exploitation of discovered vulnerabilities to validate their existence and assess their impact.

## Features

- **Plugin-based Architecture**: Easily extend with new exploitation techniques
- **Safe Simulation Mode**: Perform simulated exploits without causing harm
- **Multiple Exploitation Types**: SQL Injection, Command Injection, and more
- **Comprehensive Results**: Get detailed information about exploitation attempts
- **API Integration**: Fully integrated with the SentinelProbe API

## Plugin System

The Exploitation Engine is built on a flexible plugin system that allows for new exploitation techniques to be added easily:

- **Abstract Base Class**: All plugins extend the `ExploitPlugin` base class
- **Standardized Interface**: Consistent methods for payload generation and execution
- **Vulnerability Matching**: Plugins automatically match to applicable vulnerabilities
- **Risk Assessment**: Built-in risk level calculation for each exploit

## Available Plugins

### SQL Injection

- **MySQL Injection**: Exploits SQL injection vulnerabilities in MySQL databases
- **PostgreSQL Injection**: Exploits SQL injection vulnerabilities in PostgreSQL databases

### Command Injection

- **Command Execution**: Exploits command injection vulnerabilities to execute OS commands
- **Multiple Payload Types**: Information gathering, file access, and persistence payloads

## Usage

### API Endpoints

The following API endpoints are available:

- `GET /exploitation/plugins`: Get all available exploitation plugins
- `GET /exploitation/plugins/{plugin_name}`: Get information about a specific plugin
- `GET /exploitation/plugins/by-vulnerability/{vulnerability_id}`: Get plugins applicable to a vulnerability
- `POST /exploitation/payload`: Generate an exploitation payload
- `POST /exploitation/execute`: Execute an exploit

### Example: Executing an Exploit

```python
import requests

# Find applicable plugins for a vulnerability
vulnerability_id = 123
response = requests.get(f"http://localhost:8000/api/exploitation/plugins/by-vulnerability/{vulnerability_id}")
applicable_plugins = response.json()

if applicable_plugins:
    # Choose the first applicable plugin
    plugin_name = applicable_plugins[0]["name"]

    # Execute the exploit
    payload = {
        "plugin_name": plugin_name,
        "vulnerability_id": vulnerability_id,
        "config": {
            "safe_mode": True,
            "parameters": {
                "payload_type": "information_gathering"
            }
        }
    }

    response = requests.post("http://localhost:8000/api/exploitation/execute", json=payload)
    result = response.json()

    print(f"Exploitation {'successful' if result['success'] else 'failed'}")
    print(f"Output: {result['raw_output']}")
```

## Extending with New Plugins

To create a new exploitation plugin:

1. Create a new Python file in the `sentinelprobe/exploitation/plugins` directory
2. Extend the `ExploitPlugin` abstract base class
3. Implement all required methods and properties
4. The plugin will be automatically discovered and registered

Example skeleton for a new plugin:

```python
from sentinelprobe.exploitation.models import ExploitType, PayloadType
from sentinelprobe.exploitation.plugin import ExploitPlugin

class MyExploitPlugin(ExploitPlugin):
    @property
    def name(self) -> str:
        return "My Exploit"

    @property
    def description(self) -> str:
        return "Description of my exploit"

    @property
    def exploit_type(self) -> ExploitType:
        return ExploitType.OTHER

    @property
    def payload_type(self) -> PayloadType:
        return PayloadType.OTHER

    @property
    def target_services(self) -> List[str]:
        return ["service1", "service2"]

    @property
    def risk_level(self) -> int:
        return 5  # Medium risk

    # Implement other required methods...
```

## Safety and Ethics

The Exploitation Engine is designed with safety in mind:

- **Safe Mode**: By default, all exploits run in safe mode
- **Simulation**: Exploits simulate the attack without causing actual damage
- **Authorization**: API endpoints require proper authentication
- **Logging**: All exploitation attempts are logged for audit purposes

Always ensure you have proper authorization before testing vulnerabilities, even in a simulated environment.
